(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6133],{1363:(e,t,a)=>{"use strict";a.d(t,{z:()=>d});var r=a(95155),n=a(12115),i=a(32467),l=a(83101);let s=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.filter(Boolean).join(" ")},o=(0,l.F)(["gradient-button","inline-flex items-center justify-center","rounded-[11px] min-w-[132px] px-9 py-4","text-base leading-[19px] font-[500] text-white","font-sans font-bold","focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring","disabled:pointer-events-none disabled:opacity-50"],{variants:{variant:{default:"",variant:"gradient-button-variant gradient-button-annadanam",temple:"gradient-button-temple",pooja:"gradient-button-pooja",annadanam:"gradient-button-annadanam"}},defaultVariants:{variant:"default"}}),d=n.forwardRef((e,t)=>{let{className:a,variant:n,asChild:l=!1,...d}=e,c=l?i.DX:"button";return(0,r.jsx)(c,{className:s(o({variant:n,className:a})),ref:t,...d})});d.displayName="GradientButton"},10489:(e,t,a)=>{"use strict";a.d(t,{b:()=>s});var r=a(12115),n=a(97602),i=a(95155),l=r.forwardRef((e,t)=>(0,i.jsx)(n.sG.label,{...e,ref:t,onMouseDown:t=>{var a;t.target.closest("button, input, select, textarea")||(null==(a=e.onMouseDown)||a.call(e,t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));l.displayName="Label";var s=l},20063:(e,t,a)=>{"use strict";var r=a(47260);a.o(r,"usePathname")&&a.d(t,{usePathname:function(){return r.usePathname}}),a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}}),a.o(r,"useSearchParams")&&a.d(t,{useSearchParams:function(){return r.useSearchParams}})},27937:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(71847).A)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},30937:(e,t,a)=>{Promise.resolve().then(a.bind(a,87266))},31120:(e,t,a)=>{"use strict";a.d(t,{T:()=>l});var r=a(95155),n=a(12115),i=a(64269);let l=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)("textarea",{className:(0,i.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),ref:t,...n})});l.displayName="Textarea"},32467:(e,t,a)=>{"use strict";a.d(t,{DX:()=>s,TL:()=>l});var r=a(12115),n=a(94446),i=a(95155);function l(e){let t=function(e){let t=r.forwardRef((e,t)=>{let{children:a,...i}=e;if(r.isValidElement(a)){var l,s,o;let e,d,c=(d=(e=null==(s=Object.getOwnPropertyDescriptor((l=a).props,"ref"))?void 0:s.get)&&"isReactWarning"in e&&e.isReactWarning)?l.ref:(d=(e=null==(o=Object.getOwnPropertyDescriptor(l,"ref"))?void 0:o.get)&&"isReactWarning"in e&&e.isReactWarning)?l.props.ref:l.props.ref||l.ref,u=function(e,t){let a={...t};for(let r in t){let n=e[r],i=t[r];/^on[A-Z]/.test(r)?n&&i?a[r]=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];let r=i(...t);return n(...t),r}:n&&(a[r]=n):"style"===r?a[r]={...n,...i}:"className"===r&&(a[r]=[n,i].filter(Boolean).join(" "))}return{...e,...a}}(i,a.props);return a.type!==r.Fragment&&(u.ref=t?(0,n.t)(t,c):c),r.cloneElement(a,u)}return r.Children.count(a)>1?r.Children.only(null):null});return t.displayName="".concat(e,".SlotClone"),t}(e),a=r.forwardRef((e,a)=>{let{children:n,...l}=e,s=r.Children.toArray(n),o=s.find(d);if(o){let e=o.props.children,n=s.map(t=>t!==o?t:r.Children.count(e)>1?r.Children.only(null):r.isValidElement(e)?e.props.children:null);return(0,i.jsx)(t,{...l,ref:a,children:r.isValidElement(e)?r.cloneElement(e,void 0,n):null})}return(0,i.jsx)(t,{...l,ref:a,children:n})});return a.displayName="".concat(e,".Slot"),a}var s=l("Slot"),o=Symbol("radix.slottable");function d(e){return r.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===o}},83101:(e,t,a)=>{"use strict";a.d(t,{F:()=>l});var r=a(2821);let n=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,i=r.$,l=(e,t)=>a=>{var r;if((null==t?void 0:t.variants)==null)return i(e,null==a?void 0:a.class,null==a?void 0:a.className);let{variants:l,defaultVariants:s}=t,o=Object.keys(l).map(e=>{let t=null==a?void 0:a[e],r=null==s?void 0:s[e];if(null===t)return null;let i=n(t)||n(r);return l[e][i]}),d=a&&Object.entries(a).reduce((e,t)=>{let[a,r]=t;return void 0===r||(e[a]=r),e},{});return i(e,o,null==t||null==(r=t.compoundVariants)?void 0:r.reduce((e,t)=>{let{class:a,className:r,...n}=t;return Object.entries(n).every(e=>{let[t,a]=e;return Array.isArray(a)?a.includes({...s,...d}[t]):({...s,...d})[t]===a})?[...e,a,r]:e},[]),null==a?void 0:a.class,null==a?void 0:a.className)}},87266:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>b});var r=a(95155),n=a(48210),i=a(20063),l=a(1363),s=a(12115),o=a(50276),d=a(86948),c=a(65142),u=a(31120),m=a(76444),h=a(33946),p=a(96648),g=a(67952),f=a(75924);let v=new Date(2025,10,5),x=new Date(2026,0,7);function b(){(0,i.useRouter)();let{show:e}=(0,h.M)(),[t,b]=(0,s.useState)(v),[y,j]=(0,s.useState)(""),[w,N]=(0,s.useState)(""),[S,k]=(0,s.useState)(""),[M,P]=(0,s.useState)(""),[C,D]=(0,s.useState)(""),[A,R]=(0,s.useState)(""),[_,F]=(0,s.useState)(""),[E,q]=(0,s.useState)(""),[B,O]=(0,s.useState)(!1),[Y,J]=(0,s.useState)(""),[T,U]=(0,s.useState)(""),[z,I]=(0,s.useState)(new Map),L=(0,s.useRef)("");(0,s.useEffect)(()=>{let e=new Date,t=e.getHours(),a=new Date(e.getFullYear(),e.getMonth(),e.getDate());t>=21&&(a=new Date(a.getTime()+864e5)),a<v&&(a=v),a>x&&(a=x),b(a)},[]),(0,s.useEffect)(()=>{(async()=>{try{let e=(0,p.getSupabaseBrowserClient)(),{data:t}=await e.from("admin_config").select("value").eq("key","pooja_blocked_dates").maybeSingle(),a=null==t?void 0:t.value,r=new Map,n=(e,t)=>{let a=String(e),n=r.get(a)||new Set;n.add(String(t)),r.set(a,n)},i=[];if(a)if(Array.isArray(a))i=a;else try{i=JSON.parse(String(a))}catch(e){i=[]}else i=[];if(Array.isArray(i))for(let e of i)"string"==typeof e?(n(e,"10:30 AM"),n(e,"6:30 PM")):e&&"object"==typeof e&&e.date&&e.session&&n(String(e.date),String(e.session));I(r)}catch(e){}})()},[]);let V=(0,s.useMemo)(()=>{let e=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0");return"".concat(e,"-").concat(a,"-").concat(r)},[t]),G=e=>{let t="".concat(e.getFullYear(),"-").concat(String(e.getMonth()+1).padStart(2,"0"),"-").concat(String(e.getDate()).padStart(2,"0")),a=z.get(t);return(null==a?void 0:a.has("10:30 AM"))&&(null==a?void 0:a.has("6:30 PM"))},W=(0,s.useMemo)(()=>z.get(V)||new Set,[z,V]),H=(0,s.useMemo)(()=>{let e=new Set(W),a=new Date;if(t.getFullYear()===a.getFullYear()&&t.getMonth()===a.getMonth()&&t.getDate()===a.getDate()){let t=a.getHours();t>=11&&e.add("10:30 AM"),t>=21&&(e.add("10:30 AM"),e.add("6:30 PM"))}return e},[W,t]);async function Z(e){try{let{PDFDocument:t,StandardFonts:r,rgb:n}=await a.e(3394).then(a.bind(a,63394)),i=await t.create(),l=i.addPage(),{width:s,height:o}=l.getSize(),d=await i.embedFont(r.Helvetica),c=await i.embedFont(r.HelveticaBold);l.drawText("Pooja Pass",{x:40,y:o-40-18,size:18,font:c,color:n(0,0,0)});let u=o-40-36,m=(e,t)=>{let a="".concat(e,": ").concat(null!=t?t:"-");l.drawText(a,{x:40,y:u,size:11,font:d,color:n(0,0,0)}),u-=16};m("Name",e.name),m("Email",e.email),e.phone&&m("Phone",e.phone),m("Date",e.date),m("Session",e.session),e.spouse_name&&m("Spouse",e.spouse_name),e.children_names&&m("Children",e.children_names),e.nakshatram&&m("Nakshatram",e.nakshatram),e.gothram&&m("Gothram",e.gothram);let h="POOJA:".concat(e.id,":").concat(e.qr_token||""),p="https://api.qrserver.com/v1/create-qr-code/?size=256x256&data=".concat(encodeURIComponent(h)),g=await fetch(p),f=new Uint8Array(await g.arrayBuffer()),v=await i.embedPng(f),x=Math.min(s-80,220);l.drawImage(v,{x:40,y:Math.max(40,u-x-10),width:x,height:x});let b=await i.save(),y=new Blob([b],{type:"application/pdf"}),j=URL.createObjectURL(y),w=document.createElement("a");w.href=j,w.download="pooja-pass-".concat(e.date,".pdf"),document.body.appendChild(w),w.click(),w.remove(),URL.revokeObjectURL(j)}catch(e){}}(0,s.useEffect)(()=>{let e=L.current,t="10:30 AM",a="6:30 PM",r="23000",n="18000";Y&&(e!==t||Y!==r)&&(e!==a||Y!==n)||(y===t?J(r):y===a&&J(n)),L.current=y},[y]);let $=async()=>{try{let t=Number(Y);if(!w.trim()||!S.trim()||!y||!M.trim()||!C.trim()||!_.trim()||!E.trim()||!T.trim()||!Number.isFinite(t)||t<=0)return void e({title:"Missing info",description:"Please fill all details, enter a valid amount and UTR, and select a session.",variant:"warning"});O(!0);let a=(0,p.getSupabaseBrowserClient)();try{let t="ssabarisasthass@gmail.com".split(/[\s,;]+/).filter(Boolean);if(!(t.length>0&&t.includes(String(n.email||"").toLowerCase()))&&!await (0,f.a)(a)){let t=window.location.pathname+window.location.search;e({title:"Identity document required",description:"Please upload Aadhaar or PAN in your profile. Redirecting in 5 seconds…",variant:"warning",durationMs:5e3}),setTimeout(()=>{try{window.location.assign("/profile/edit/?next="+encodeURIComponent(t))}catch(e){}},5e3),O(!1);return}}catch(e){}let{data:r}=await a.auth.getUser(),n=null==r?void 0:r.user;if(!(null==n?void 0:n.id))return void e({title:"Sign-in required",description:"Please sign in to book a pooja.",variant:"warning"});let i={date:V,session:y,name:w.trim(),email:S.trim(),phone:M.trim(),spouse_name:C.trim(),children_names:A.trim()||null,nakshatram:_.trim(),gothram:E.trim(),amount:t,utr:T.trim(),user_id:n.id},{data:l,error:s}=await a.from("Pooja-Bookings").insert(i).select("*").single();if(s||!l)return void e({title:"Booking failed",description:(null==s?void 0:s.message)||"Could not save booking",variant:"error"});e({title:"Pooja booked",description:"".concat(V," • ").concat(y),variant:"success"});try{await Z({id:String(l.id),qr_token:String(l.qr_token||""),date:V,session:y,name:w.trim(),email:S.trim(),phone:M.trim(),spouse_name:C.trim(),children_names:A.trim()||null,nakshatram:_.trim(),gothram:E.trim()})}catch(e){}try{await (0,g.Z)({to:S.trim(),subject:"Pooja booking confirmed",text:"Your booking for ".concat(V," (").concat(y,") has been received."),html:"<p>Your booking for <strong>".concat(V,"</strong> (<strong>").concat(y,"</strong>) has been received.</p>")})}catch(e){}j(""),J(""),U("")}catch(t){e({title:"Booking failed",description:(null==t?void 0:t.message)||"Unexpected error",variant:"error"})}finally{O(!1)}};return(0,r.jsx)(n.default,{children:(0,r.jsx)("main",{className:"min-h-[60vh] w-full flex items-start justify-center px-6 pt-24 pb-16",children:(0,r.jsxs)("div",{className:"w-full max-w-4xl space-y-8",children:[(0,r.jsxs)("header",{className:"text-center",children:[(0,r.jsx)("h1",{className:"text-3xl md:text-4xl font-bold",children:"Pooja Booking"}),(0,r.jsx)("p",{className:"mt-2 text-muted-foreground",children:"Booking window: 5 Nov 2025 – 7 Jan 2026. Sessions: 10:30 AM and 6:30 PM."})]}),(0,r.jsx)("section",{className:"rounded-2xl border border-border bg-card/70 p-6 shadow-sm",children:(0,r.jsxs)("div",{className:"grid gap-6 md:grid-cols-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-lg font-semibold mb-3",children:"Select Date"}),(0,r.jsx)(d.Zp,{children:(0,r.jsx)(d.Wu,{className:"p-4",children:(0,r.jsx)("div",{className:"max-h-[360px] overflow-y-auto sm:max-h-none",children:(0,r.jsx)(o.V,{selected:t,onSelect:e=>{e&&!(e<v)&&!(e>x)&&(G(e)||b(e))},disabled:e=>e<v||e>x||G(e),completed:e=>{let t=new Date,a=new Date(t.getFullYear(),t.getMonth(),t.getDate()),r=new Date(e.getFullYear(),e.getMonth(),e.getDate());return 2025===e.getFullYear()&&10===e.getMonth()&&5===e.getDate()||r<a},className:"rounded-lg border-0",fromDate:v,toDate:x})})})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-lg font-semibold mb-3",children:"Your Details"}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)(m.J,{htmlFor:"name",children:"Full Name"}),(0,r.jsx)(c.p,{id:"name",value:w,onChange:e=>N(e.target.value),placeholder:"Your name",required:!0,autoComplete:"name",autoCapitalize:"words"})]}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)(m.J,{htmlFor:"email",children:"Email"}),(0,r.jsx)(c.p,{id:"email",type:"email",value:S,onChange:e=>k(e.target.value),placeholder:"you@example.com",required:!0,autoComplete:"email",inputMode:"email"})]}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)(m.J,{htmlFor:"phone",children:"Phone Number"}),(0,r.jsx)(c.p,{id:"phone",type:"tel",value:M,onChange:e=>P(e.target.value),placeholder:"Your phone number",required:!0,autoComplete:"tel",inputMode:"tel",pattern:"^\\+?[0-9]{10,15}$"})]}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)(m.J,{htmlFor:"spouse",children:"Spouse Name"}),(0,r.jsx)(c.p,{id:"spouse",value:C,onChange:e=>D(e.target.value),placeholder:"Spouse name",autoCapitalize:"words",required:!0})]}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)(m.J,{htmlFor:"children",children:"Children Names (optional)"}),(0,r.jsx)(u.T,{id:"children",value:A,onChange:e=>R(e.target.value),placeholder:"Comma separated or one per line"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)(m.J,{htmlFor:"nakshatram",children:"Nakshatram"}),(0,r.jsx)(c.p,{id:"nakshatram",value:_,onChange:e=>F(e.target.value),placeholder:"e.g., Rohini",autoCapitalize:"words",required:!0})]}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)(m.J,{htmlFor:"gothram",children:"Gothram"}),(0,r.jsx)(c.p,{id:"gothram",value:E,onChange:e=>q(e.target.value),placeholder:"Your Gothram",autoCapitalize:"words",required:!0})]})]}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)(m.J,{children:"Session"}),(0,r.jsxs)("select",{className:"w-full rounded-md border border-border bg-background h-9 px-3 py-1 text-base",value:y,onChange:e=>j(e.target.value),required:!0,"aria-label":"Select session",children:[(0,r.jsx)("option",{value:"",children:"Select a session"}),!H.has("10:30 AM")&&(0,r.jsx)("option",{value:"10:30 AM",children:"Morning — 10:30 AM"}),!H.has("6:30 PM")&&(0,r.jsx)("option",{value:"6:30 PM",children:"Evening — 6:30 PM"})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)(m.J,{htmlFor:"amount",children:"Amount (₹)"}),(0,r.jsx)(c.p,{id:"amount",type:"number",inputMode:"decimal",min:"1",step:"0.01",value:Y,onChange:e=>J(e.target.value),placeholder:"Enter amount paid",required:!0})]}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)(m.J,{htmlFor:"utr",children:"Transaction ID"}),(0,r.jsx)(c.p,{id:"utr",value:T,onChange:e=>U(e.target.value),placeholder:"Enter Transaction ID",required:!0})]})]}),(0,r.jsx)("div",{className:"pt-4",children:(0,r.jsx)(l.z,{variant:"pooja",onClick:$,disabled:B,"aria-busy":B,className:"w-full sm:w-auto",children:B?"Booking…":"Book Now"})})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-lg font-semibold mb-3",children:"Payment"}),(0,r.jsx)(d.Zp,{children:(0,r.jsx)(d.Wu,{className:"p-4",children:(0,r.jsx)("div",{className:"space-y-3",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("img",{src:"/payment.png",alt:"Payment QR",className:"w-full rounded-lg border"}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground mt-2",children:"Scan to pay. Enter amount and UTR in the form."})]})})})})]})]})}),(0,r.jsx)("p",{className:"text-center text-sm text-muted-foreground",children:"Note: Pooja and Panthulu garu fee is borne by the person taking the pooja."}),(0,r.jsx)("p",{className:"text-center text-xs text-muted-foreground mt-2",children:"Misuse of this booking facility is strictly prohibited. If anyone misuses it, they will be completely terminated from all seva activities."})]})})})}},90368:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(71847).A)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},94446:(e,t,a)=>{"use strict";a.d(t,{s:()=>l,t:()=>i});var r=a(12115);function n(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function i(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return e=>{let a=!1,r=t.map(t=>{let r=n(t,e);return a||"function"!=typeof r||(a=!0),r});if(a)return()=>{for(let e=0;e<r.length;e++){let a=r[e];"function"==typeof a?a():n(t[e],null)}}}}function l(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return r.useCallback(i(...t),t)}},97602:(e,t,a)=>{"use strict";a.d(t,{hO:()=>o,sG:()=>s});var r=a(12115),n=a(47650),i=a(32467),l=a(95155),s=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let a=(0,i.TL)("Primitive.".concat(t)),n=r.forwardRef((e,r)=>{let{asChild:n,...i}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,l.jsx)(n?a:t,{...i,ref:r})});return n.displayName="Primitive.".concat(t),{...e,[t]:n}},{});function o(e,t){e&&n.flushSync(()=>e.dispatchEvent(t))}}},e=>{e.O(0,[1029,5553,951,4909,2090,8887,8441,1255,7358],()=>e(e.s=30937)),_N_E=e.O()}]);