(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[552,6648],{20063:(e,s,t)=>{"use strict";var a=t(47260);t.o(a,"usePathname")&&t.d(s,{usePathname:function(){return a.usePathname}}),t.o(a,"useRouter")&&t.d(s,{useRouter:function(){return a.useRouter}}),t.o(a,"useSearchParams")&&t.d(s,{useSearchParams:function(){return a.useSearchParams}})},33946:(e,s,t)=>{"use strict";t.d(s,{M:()=>i,S:()=>o});var a=t(95155),n=t(12115),l=t(65034);let r=(0,n.createContext)(null);function i(){let e=(0,n.useContext)(r);return e||{show:e=>{var s;let t="".concat(null!=(s=e.title)?s:"").concat(e.description?": ".concat(e.description):"").trim();try{t&&window.alert(t)}catch(e){}}}}function o(e){let{children:s}=e,[t,i]=(0,n.useState)([]),[o,c]=(0,n.useState)(!1);(0,n.useEffect)(()=>c(!0),[]);let d=(0,n.useCallback)(e=>{var s,t,a;let n=Date.now()+Math.floor(1e3*Math.random()),l={id:n,title:null!=(s=e.title)?s:"",description:null!=(t=e.description)?t:"",variant:null!=(a=e.variant)?a:"info",durationMs:"number"==typeof e.durationMs?e.durationMs:3e3};i(e=>[...e,l]),l.durationMs&&l.durationMs>0&&setTimeout(()=>{i(e=>e.filter(e=>e.id!==n))},l.durationMs)},[]),u=(0,n.useMemo)(()=>({show:d}),[d]);return(0,a.jsxs)(r.Provider,{value:u,children:[s,o?(0,a.jsx)("div",{suppressHydrationWarning:!0,className:"pointer-events-none fixed bottom-4 right-4 z-50 flex w-[92vw] max-w-md flex-col-reverse gap-3 sm:w-auto",children:t.map(e=>(0,a.jsx)("div",{className:"pointer-events-auto",children:(0,a.jsx)(l.A,{variant:e.variant,title:e.title,description:e.description})},e.id))}):null]})}},52828:(e,s,t)=>{"use strict";t.d(s,{A:()=>i});var a=t(95155),n=t(12115),l=t(20063),r=t(96648);function i(e){let{children:s}=e,[t,i]=(0,n.useState)(!0),o=(0,l.useRouter)();return((0,n.useEffect)(()=>{(async()=>{try{let e=(0,r.getSupabaseBrowserClient)(),{data:s}=await e.auth.getUser(),t=null==s?void 0:s.user,a="ssabarisasthass@gmail.com".split(/[,\s;]+/).filter(Boolean);if(!(t&&(0===a.length||a.includes((t.email||"").toLowerCase()))))return void o.replace("/admin");i(!1)}catch(e){o.replace("/admin")}})()},[o]),t)?(0,a.jsx)("main",{className:"min-h-screen grid place-items-center",children:(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Verifying admin access…"})}):(0,a.jsx)(a.Fragment,{children:s})}},63760:(e,s,t)=>{Promise.resolve().then(t.bind(t,79813))},64269:(e,s,t)=>{"use strict";t.d(s,{cn:()=>l});var a=t(2821),n=t(75889);function l(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,n.QP)((0,a.$)(s))}},65034:(e,s,t)=>{"use strict";t.d(s,{A:()=>p});var a=t(95155),n=t(12115),l=t(24342),r=t(951),i=t(61362),o=t(65229),c=t(52056),d=t(23327),u=t(64269);let m={success:(0,a.jsx)(i.A,{className:"h-6 w-6"}),error:(0,a.jsx)(o.A,{className:"h-6 w-6"}),warning:(0,a.jsx)(c.A,{className:"h-6 w-6"}),info:(0,a.jsx)(d.A,{className:"h-6 w-6"})};function p(e){let{variant:s="success",title:t="Default Alert Title",description:i="This is a default description for the alert. You can customize this text by passing props."}=e,[c,d]=(0,n.useState)(!0);return(0,a.jsx)(l.N,{children:c&&(0,a.jsxs)(r.P.div,{initial:{opacity:0,scale:.95,y:-10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:-10},transition:{duration:.25},className:(0,u.cn)("relative w-full max-w-md mx-auto p-4 rounded-2xl shadow-lg border","bg-white text-black border-black/10"),role:"status","aria-live":"polite",children:[(0,a.jsx)("button",{onClick:()=>d(!1),className:"absolute top-3 right-3 rounded-full p-1 hover:bg-black/10 transition","aria-label":"Dismiss alert",children:(0,a.jsx)(o.A,{className:"h-4 w-4"})}),(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)("div",{className:"flex-shrink-0 font-normal",children:m[s]}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("h4",{className:"text-base font-semibold",children:t}),i&&(0,a.jsx)("p",{className:"text-sm text-black opacity-80 mt-1",children:i})]})]})]})})}},79813:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>c});var a=t(95155),n=t(12115),l=t(33946),r=t(96648),i=t(52828),o=t(20063);function c(){let[e,s]=(0,n.useState)(!1),[t,c]=(0,n.useState)([]),[d,u]=(0,n.useState)(""),[m,p]=(0,n.useState)(""),{show:h}=(0,l.M)(),x=(0,o.useRouter)(),f="pooja_blocked_dates",b=async()=>{s(!0);try{let e=(0,r.getSupabaseBrowserClient)(),{data:s,error:t}=await e.from("admin_config").select("value").eq("key",f).maybeSingle();if(!t&&(null==s?void 0:s.value))try{let e=JSON.parse(String(s.value)),t=[];if(Array.isArray(e))for(let s of e)"string"==typeof s?(t.push({date:s,session:"10:30 AM"}),t.push({date:s,session:"6:30 PM"})):s&&"object"==typeof s&&s.date&&s.session&&t.push({date:String(s.date),session:String(s.session)});let a=Array.from(new Map(t.map(e=>["".concat(e.date,"|").concat(e.session),e])).values());c(a.sort((e,s)=>e.date.localeCompare(s.date)||e.session.localeCompare(s.session)))}catch(e){c([])}else c([])}finally{s(!1)}},v=async e=>{s(!0);try{let s=(0,r.getSupabaseBrowserClient)(),t={key:f,value:JSON.stringify(e),updated_at:new Date().toISOString()},{error:a}=await s.from("admin_config").upsert(t,{onConflict:"key"});if(a)throw a;c(e),h({title:"Saved",description:"Blocked sessions updated.",variant:"success"})}catch(e){h({title:"Save failed",description:(null==e?void 0:e.message)||"Check RLS policy for admin_config.",variant:"error"})}finally{s(!1)}};(0,n.useEffect)(()=>{b()},[]);let j=(0,n.useMemo)(()=>{let e=new Map;for(let s of t){let t=e.get(s.date)||[];t.push(s),e.set(s.date,t)}return Array.from(e.entries()).sort((e,s)=>e[0].localeCompare(s[0]))},[t]);return(0,a.jsx)(i.A,{children:(0,a.jsx)("main",{className:"min-h-screen p-6 md:p-10",children:(0,a.jsxs)("div",{className:"mx-auto max-w-3xl",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-center",children:"Block Pooja Sessions"}),(0,a.jsx)("div",{className:"mt-2 flex justify-between",children:(0,a.jsx)("button",{onClick:()=>x.push("/admin"),className:"rounded border px-3 py-1.5",children:"Back"})}),(0,a.jsxs)("div",{className:"rounded-xl border p-6 space-y-4 bg-card/70 mt-6",children:[(0,a.jsxs)("div",{className:"grid gap-3 sm:grid-cols-[1fr_1fr_auto] items-end",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm",htmlFor:"d",children:"Date"}),(0,a.jsx)("input",{id:"d",type:"date",value:d,onChange:e=>u(e.target.value),className:"w-full rounded border px-3 py-2 bg-background"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm",htmlFor:"s",children:"Session"}),(0,a.jsxs)("select",{id:"s",value:m,onChange:e=>p(e.target.value),className:"w-full rounded border px-3 py-2 bg-background",children:[(0,a.jsx)("option",{value:"",children:"Select session"}),(0,a.jsx)("option",{value:"10:30 AM",children:"Morning — 10:30 AM"}),(0,a.jsx)("option",{value:"6:30 PM",children:"Evening — 6:30 PM"})]})]}),(0,a.jsx)("button",{onClick:()=>{if(!d||!m)return;let e="".concat(d,"|").concat(m);if(t.some(s=>"".concat(s.date,"|").concat(s.session)===e))return;let s=[...t,{date:d,session:m}];s.sort((e,s)=>e.date.localeCompare(s.date)||e.session.localeCompare(s.session)),v(s)},disabled:!d||!m||e,className:"rounded bg-black text-white px-4 py-2",children:"Add block"})]}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Blocked sessions cannot be booked. Saved into admin_config key ",(0,a.jsx)("code",{children:"pooja_blocked_dates"}),"."]}),(0,a.jsx)("div",{className:"border rounded-md",children:(0,a.jsxs)("table",{className:"min-w-full text-sm",children:[(0,a.jsx)("thead",{className:"bg-muted/50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-3 py-2 text-left",children:"Date"}),(0,a.jsx)("th",{className:"px-3 py-2 text-left",children:"Blocked Sessions"}),(0,a.jsx)("th",{className:"px-3 py-2 text-left",children:"Action"})]})}),(0,a.jsx)("tbody",{children:0===j.length?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{className:"px-3 py-3",colSpan:3,children:"No blocked sessions."})}):j.map(e=>{let[s,n]=e;return(0,a.jsxs)("tr",{className:"border-t align-top",children:[(0,a.jsx)("td",{className:"px-3 py-2 whitespace-nowrap",children:s}),(0,a.jsx)("td",{className:"px-3 py-2",children:(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:n.map(e=>(0,a.jsxs)("span",{className:"inline-flex items-center gap-2 rounded border px-2 py-1",children:[e.session,(0,a.jsx)("button",{onClick:()=>v(t.filter(s=>s.date!==e.date||s.session!==e.session)),className:"text-xs opacity-70 hover:opacity-100","aria-label":"Unblock session",children:"✕"})]},"".concat(e.date,"|").concat(e.session)))})}),(0,a.jsx)("td",{className:"px-3 py-2",children:2===n.length?(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:"All sessions blocked"}):(0,a.jsxs)("span",{className:"text-xs text-muted-foreground",children:[2-n.length," session open"]})})]},s)})})]})})]})]})})})}},96648:(e,s,t)=>{"use strict";t.r(s),t.d(s,{getSupabaseBrowserClient:()=>l});var a=t(85553);let n=globalThis;function l(){let e="https://lszcuaduebvabtifhbgp.supabase.co",s="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxzemN1YWR1ZWJ2YWJ0aWZoYmdwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTkzOTk5NTIsImV4cCI6MjA3NDk3NTk1Mn0.voMu1-4SKxSjZ1LK6x7shGKFI37YW8PtLFJKpPYvCAM";if(!e||!s)throw Error("Supabase env vars missing. Set NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY.");let t=function(e,s){try{let s=new URL(e).host.split(".")[0];return"ayya.supabase.".concat(s,".auth.v1")}catch(e){return"ayya.supabase.".concat((s||"").slice(0,8),".auth.v1")}}(e,s);if(n.__supabaseClients[t])return n.__supabaseClients[t];let l=(0,a.UU)(e,s,{auth:{persistSession:!0,autoRefreshToken:!0,flowType:"pkce",detectSessionInUrl:!0,storageKey:t},global:{headers:{"x-ayya-client":"web"}},realtime:{params:{eventsPerSecond:2}}});return n.__supabaseClients[t]=l,l}null!=n.__supabaseClients||(n.__supabaseClients={})}},e=>{e.O(0,[1029,5553,951,4909,2090,8441,1255,7358],()=>e(e.s=63760)),_N_E=e.O()}]);