(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4817,6648],{11854:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>l});var a=t(95155),n=t(12115),i=t(96648);function l(){let[e,s]=(0,n.useState)(!0),[t,l]=(0,n.useState)(null),[r,d]=(0,n.useState)(null);return(0,n.useEffect)(()=>{(async()=>{s(!0),l(null);try{var e;let t=new URLSearchParams(window.location.search);String(t.get("b")||t.get("id")||"").trim();let a=String(t.get("t")||t.get("token")||"").trim();if(!a){l("Missing QR token"),s(!1);return}let n=(0,i.getSupabaseBrowserClient)(),{data:r,error:c}=await n.rpc("lookup_annadanam_pass",{token:a});if(c){l(c.message||"Invalid or expired pass"),s(!1);return}let m=Array.isArray(r)?null!=(e=r[0])?e:null:null!=r?r:null;if(!m){l("Invalid or expired pass"),s(!1);return}d(m)}catch(e){l((null==e?void 0:e.message)||"Failed to load pass")}finally{s(!1)}})()},[]),(0,a.jsx)("main",{className:"min-h-screen p-6 md:p-10",children:(0,a.jsxs)("div",{className:"mx-auto max-w-xl",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"Annadanam Pass"}),e&&(0,a.jsx)("p",{className:"mt-4 text-sm text-muted-foreground",children:"Loading…"}),t&&(0,a.jsx)("p",{className:"mt-4 text-sm text-red-600",role:"alert",children:t}),r&&(0,a.jsxs)("div",{className:"mt-4 rounded-xl border bg-card/70 p-6 space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Booking ID"}),(0,a.jsx)("div",{className:"font-mono text-xs",children:r.id})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Name"}),(0,a.jsx)("div",{className:"text-sm",children:r.name})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Email"}),(0,a.jsx)("div",{className:"text-sm",children:r.email})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Date"}),(0,a.jsx)("div",{className:"text-sm",children:r.date})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Session"}),(0,a.jsx)("div",{className:"text-sm",children:r.session})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Qty"}),(0,a.jsx)("div",{className:"text-sm",children:r.qty})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Status"}),(0,a.jsx)("div",{className:"text-sm",children:r.status})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Attended"}),(0,a.jsx)("div",{className:"text-sm",children:r.attended_at?String(r.attended_at).slice(0,19).replace("T"," "):"—"})]}),(0,a.jsx)("p",{className:"mt-4 text-xs text-muted-foreground",children:"Show this pass to the admin volunteer at the Annadanam counter during your session time."})]})]})})}},14579:(e,s,t)=>{Promise.resolve().then(t.bind(t,11854))},96648:(e,s,t)=>{"use strict";t.r(s),t.d(s,{getSupabaseBrowserClient:()=>i});var a=t(85553);let n=globalThis;function i(){let e="https://lszcuaduebvabtifhbgp.supabase.co",s="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxzemN1YWR1ZWJ2YWJ0aWZoYmdwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTkzOTk5NTIsImV4cCI6MjA3NDk3NTk1Mn0.voMu1-4SKxSjZ1LK6x7shGKFI37YW8PtLFJKpPYvCAM";if(!e||!s)throw Error("Supabase env vars missing. Set NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY.");let t=function(e,s){try{let s=new URL(e).host.split(".")[0];return"ayya.supabase.".concat(s,".auth.v1")}catch(e){return"ayya.supabase.".concat((s||"").slice(0,8),".auth.v1")}}(e,s);if(n.__supabaseClients[t])return n.__supabaseClients[t];let i=(0,a.UU)(e,s,{auth:{persistSession:!0,autoRefreshToken:!0,flowType:"pkce",detectSessionInUrl:!0,storageKey:t},global:{headers:{"x-ayya-client":"web"}},realtime:{params:{eventsPerSecond:2}}});return n.__supabaseClients[t]=i,i}null!=n.__supabaseClients||(n.__supabaseClients={})}},e=>{e.O(0,[1029,5553,8441,1255,7358],()=>e(e.s=14579)),_N_E=e.O()}]);