"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5148],{5148:(e,t,a)=>{a.r(t),a.d(t,{default:()=>b});var l=a(95155),r=a(12115),i=a(20063),n=a(52619),s=a.n(n),d=a(15279),c=a(24033),o=a(71847);let u=(0,o.A)("log-in",[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]]);var h=a(65229);let m=(0,o.A)("camera",[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]),x=(0,o.A)("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]);var g=a(10383),p=a(33946);function b(){let e=(0,i.useRouter)(),[t,n]=(0,r.useState)(!1),[o,b]=(0,r.useState)(!1),[f,v]=(0,r.useState)(null),[w,y]=(0,r.useState)("User"),[k,j]=(0,r.useState)(""),[N,_]=(0,r.useState)(!1),{show:S}=(0,p.M)(),C=(0,r.useRef)(null),A=(0,r.useRef)(null);(0,d.Wr)(C,()=>n(!1));(0,r.useEffect)(()=>{0;let e=null;return(async()=>{try{let{getSupabaseBrowserClient:t}=await Promise.all([a.e(1029),a.e(5553),a.e(6648)]).then(a.bind(a,96648)),l=t();A.current=l;let r=async()=>{try{var e,t,a,r,i;let{data:n}=await l.auth.getUser(),s=null==n?void 0:n.user,d=!!s;if(b(d),!d){v(null),y("User"),j("");return}let c=((null==(e=s.user_metadata)?void 0:e.full_name)||(null==(t=s.user_metadata)?void 0:t.name)||"").toString(),o=((null==(a=s.user_metadata)?void 0:a.avatar_url)||(null==(r=s.user_metadata)?void 0:r.picture)||"").toString();j(s.email||"");try{let e=(null==s?void 0:s.identities)||[],t=Array.isArray(e)?e.map(e=>e.provider):[];_(t.includes("google"))}catch(e){_(!1)}try{let{data:e}=await l.from("Profile-Table").select("name, full_name, image_url, avatar_url").eq("user_id",s.id).maybeSingle();e||(e=null!=(i=(await l.from("Profile-Table").select("name, full_name, image_url, avatar_url").eq("id",s.id).maybeSingle()).data)?i:null),e&&(c=(e.name||e.full_name||c||"").toString(),o=(e.image_url||e.avatar_url||o||"").toString())}catch(e){}y(c||s.email||"User"),v(o||null)}catch(e){b(!1),v(null),y("User"),j("")}};r();let{data:i}=l.auth.onAuthStateChange((e,t)=>{r()});e=()=>{var e,t;return null==(t=i.subscription)||null==(e=t.unsubscribe)?void 0:e.call(t)}}catch(e){b(!1),v(null)}})(),()=>{try{null==e||e()}catch(e){}}},[]);let M=()=>{try{e.push("/sign-in/")}catch(e){window.location.assign("/sign-in/")}},P=async()=>{var t,l,r,i;0;let s=A.current;s||(A.current=s=(await Promise.all([a.e(1029),a.e(5553),a.e(6648)]).then(a.bind(a,96648))).getSupabaseBrowserClient());let d="User";try{let{data:e}=await s.auth.getUser(),t=null==e?void 0:e.user;if(t){let e=((null==(l=t.user_metadata)?void 0:l.full_name)||(null==(r=t.user_metadata)?void 0:r.name)||"").toString();if(!e)try{let{data:a}=await s.from("Profile-Table").select("name, full_name").eq("user_id",t.id).maybeSingle();a||(a=null!=(i=(await s.from("Profile-Table").select("name, full_name").eq("id",t.id).maybeSingle()).data)?i:null),e=((null==a?void 0:a.name)||(null==a?void 0:a.full_name)||"").toString()}catch(e){}d=e||t.email||d}}catch(e){}await s.auth.signOut(),b(!1),n(!1),S({title:"Logged out",description:"".concat(d),variant:"info"});try{e.replace("/")}catch(e){}window.location.assign("/")},U=async()=>{try{let e=A.current;e||(A.current=e=(await Promise.all([a.e(1029),a.e(5553),a.e(6648)]).then(a.bind(a,96648))).getSupabaseBrowserClient());let t=window.location.origin.replace(/\/$/,""),{error:l}=await e.auth.linkIdentity({provider:"google",options:{redirectTo:"".concat(t,"/auth/callback")}});if(l)return void S({title:"Link failed",description:l.message,variant:"error"});S({title:"Continue with Google",description:"Complete linking in the Google window.",variant:"info"})}catch(e){S({title:"Link failed",description:(null==e?void 0:e.message)||"Unexpected error",variant:"error"})}},G=(w||"U").trim().charAt(0).toUpperCase();return(0,l.jsxs)("div",{ref:C,className:"relative",children:[o?(0,l.jsxs)("button",{type:"button",onClick:()=>{if(!o)return M();n(e=>!e)},"aria-expanded":t,className:"inline-flex items-center gap-2 rounded-full bg-white/15 px-2.5 py-1.5 text-xs font-medium text-white ring-1 ring-white/20 hover:bg-white/25",children:[f?(0,l.jsx)("img",{src:f,alt:w||"Profile",className:"h-8 w-8 rounded-full object-cover ring-1 ring-white/20",referrerPolicy:"no-referrer"}):(0,l.jsx)("span",{className:"grid place-items-center h-8 w-8 rounded-full bg-white/20 text-[0.8rem] font-semibold",children:G}),(0,l.jsx)(c.A,{size:14,className:"opacity-80"})]}):(0,l.jsxs)(s(),{href:"/sign-in/",className:"inline-flex items-center gap-2 rounded-full bg-white/15 px-2.5 py-1.5 text-xs font-medium text-white ring-1 ring-white/20 hover:bg-white/25",children:[(0,l.jsx)(u,{size:16}),(0,l.jsx)("span",{className:"hidden sm:inline",children:"Login"})]}),t&&(0,l.jsx)("div",{className:"absolute right-0 top-[110%] z-50",children:(0,l.jsxs)("div",{className:"w-[340px] sm:w-[380px] overflow-hidden rounded-2xl border border-border bg-white/95 text-foreground shadow-xl backdrop-blur dark:bg-neutral-900/95",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 text-sm border-b border-border/60",children:[(0,l.jsx)("span",{className:"truncate max-w-[260px] sm:max-w-[300px] opacity-80",children:k||(o?"Account":"Not signed in")}),(0,l.jsx)("button",{onClick:()=>n(!1),className:"p-1 rounded hover:bg-black/5 dark:hover:bg-white/10",children:(0,l.jsx)(h.A,{className:"h-4 w-4"})})]}),(0,l.jsxs)("div",{className:"px-6 pt-5 pb-4 text-center",children:[(0,l.jsxs)("div",{className:"relative mx-auto h-16 w-16",children:[f?(0,l.jsx)("img",{src:f,alt:w||"Profile",className:"h-16 w-16 rounded-full object-cover ring-1 ring-black/10 dark:ring-white/10"}):(0,l.jsx)("div",{className:"grid place-items-center h-16 w-16 rounded-full bg-violet-500 text-white text-2xl font-bold ring-1 ring-black/10 dark:ring-white/10",children:G}),(0,l.jsx)("button",{onClick:()=>e.push("/profile/edit"),title:"Change photo",className:"absolute -bottom-0 -right-1 grid place-items-center h-6 w-6 rounded-full bg-white text-black shadow-sm ring-1 ring-black/10 dark:bg-neutral-800 dark:text-white dark:ring-white/10",children:(0,l.jsx)(m,{className:"h-3.5 w-3.5"})})]}),(0,l.jsx)("div",{className:"mt-3 text-xl font-semibold",children:o?"Hi, ".concat(w.split(" ")[0]||"there","!"):"Welcome!"}),o?(0,l.jsx)("button",{onClick:()=>e.push("/profile/edit/"),className:"mt-3 inline-flex items-center justify-center rounded-full border px-4 py-2 text-sm hover:bg-black/5 dark:hover:bg-white/10",children:"Edit your profile"}):(0,l.jsx)("button",{onClick:M,className:"mt-3 inline-flex items-center justify-center rounded-full border px-4 py-2 text-sm hover:bg-black/5 dark:hover:bg-white/10",children:"Sign in to your account"})]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-3 px-4 pb-4",children:[(0,l.jsx)("button",{onClick:()=>window.location.href="/sign-in/",className:"rounded-2xl border px-4 py-3 text-sm text-left hover:bg-black/5 dark:hover:bg-white/10",children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("span",{className:"grid place-items-center h-6 w-6 rounded-full border",children:"+"}),(0,l.jsx)("span",{children:"Add account"})]})}),o?N?(0,l.jsx)("button",{disabled:!0,className:"rounded-2xl border px-4 py-3 text-sm text-left opacity-60",title:"Google already linked",children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("span",{className:"grid place-items-center h-6 w-6 rounded-full border",children:"G"}),(0,l.jsx)("span",{children:"Google linked"})]})}):(0,l.jsx)("button",{onClick:U,className:"rounded-2xl border px-4 py-3 text-sm text-left hover:bg-black/5 dark:hover:bg-white/10",children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("span",{className:"grid place-items-center h-6 w-6 rounded-full border",children:"G"}),(0,l.jsx)("span",{children:"Link Google"})]})}):(0,l.jsx)("div",{}),(0,l.jsx)("button",{onClick:o?P:M,className:"rounded-2xl border px-4 py-3 text-sm text-left hover:bg-black/5 dark:hover:bg-white/10",children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(x,{className:"h-4 w-4"}),(0,l.jsx)("span",{children:o?"Sign out":"Sign in"})]})})]}),o&&(0,l.jsx)("div",{className:"px-4 pb-4",children:(0,l.jsxs)("button",{onClick:()=>window.location.href="/calendar/annadanam",className:"w-full inline-flex items-center justify-center gap-2 rounded-xl bg-amber-600 text-white px-4 py-2.5 text-sm hover:bg-amber-500",children:[(0,l.jsx)(g.A,{className:"h-4 w-4"})," Annadanam Virtual Queue Booking"]})}),(0,l.jsxs)("div",{className:"flex items-center justify-center gap-2 px-6 py-3 text-xs text-muted-foreground border-t",children:[(0,l.jsx)("a",{href:"#",className:"hover:underline",children:"Privacy Policy"}),(0,l.jsx)("span",{children:"â€¢"}),(0,l.jsx)("a",{href:"/terms",className:"hover:underline",children:"Terms of Service"})]})]})})]})}},10383:(e,t,a)=>{a.d(t,{A:()=>l});let l=(0,a(71847).A)("calendar-days",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]])}}]);