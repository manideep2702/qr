(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4817,6648],{11854:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>l});var a=t(95155),i=t(12115),n=t(96648);function l(){let[e,s]=(0,i.useState)(!0),[t,l]=(0,i.useState)(null),[r,d]=(0,i.useState)(null);return(0,i.useEffect)(()=>{(async()=>{s(!0),l(null);try{let e=new URLSearchParams(window.location.search),t=String(e.get("b")||e.get("id")||"").trim(),a=String(e.get("t")||e.get("token")||"").trim();if(!a){l("Missing QR token"),s(!1);return}if(!/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(a)){l("Invalid QR token"),s(!1);return}let i=(0,n.getSupabaseBrowserClient)(),{data:r,error:c}=await i.from("Bookings").select("id,created_at,date,session,name,email,phone,qty,status,attended_at").eq("qr_token",a).maybeSingle();if(c)throw c;if(!r){l("Invalid or expired pass"),s(!1);return}if(t&&String(r.id)!==t){l("Pass does not match this booking id"),s(!1);return}d(r)}catch(e){l((null==e?void 0:e.message)||"Failed to load pass")}finally{s(!1)}})()},[]),(0,a.jsx)("main",{className:"min-h-screen p-6 md:p-10",children:(0,a.jsxs)("div",{className:"mx-auto max-w-xl",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"Annadanam Pass"}),e&&(0,a.jsx)("p",{className:"mt-4 text-sm text-muted-foreground",children:"Loading…"}),t&&(0,a.jsx)("p",{className:"mt-4 text-sm text-red-600",role:"alert",children:t}),r&&(0,a.jsxs)("div",{className:"mt-4 rounded-xl border bg-card/70 p-6 space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Booking ID"}),(0,a.jsx)("div",{className:"font-mono text-xs",children:r.id})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Name"}),(0,a.jsx)("div",{className:"text-sm",children:r.name})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Email"}),(0,a.jsx)("div",{className:"text-sm",children:r.email})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Date"}),(0,a.jsx)("div",{className:"text-sm",children:r.date})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Session"}),(0,a.jsx)("div",{className:"text-sm",children:r.session})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Qty"}),(0,a.jsx)("div",{className:"text-sm",children:r.qty})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Status"}),(0,a.jsx)("div",{className:"text-sm",children:r.status})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Attended"}),(0,a.jsx)("div",{className:"text-sm",children:r.attended_at?String(r.attended_at).slice(0,19).replace("T"," "):"—"})]}),(0,a.jsx)("p",{className:"mt-4 text-xs text-muted-foreground",children:"Show this pass to the admin volunteer at the Annadanam counter during your session time."})]})]})})}},14579:(e,s,t)=>{Promise.resolve().then(t.bind(t,11854))},96648:(e,s,t)=>{"use strict";t.r(s),t.d(s,{getSupabaseBrowserClient:()=>n});var a=t(85553);let i=globalThis;function n(){let e="https://lszcuaduebvabtifhbgp.supabase.co",s="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxzemN1YWR1ZWJ2YWJ0aWZoYmdwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTkzOTk5NTIsImV4cCI6MjA3NDk3NTk1Mn0.voMu1-4SKxSjZ1LK6x7shGKFI37YW8PtLFJKpPYvCAM";if(!e||!s)throw Error("Supabase env vars missing. Set NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY.");let t=function(e,s){try{let s=new URL(e).host.split(".")[0];return"ayya.supabase.".concat(s,".auth.v1")}catch(e){return"ayya.supabase.".concat((s||"").slice(0,8),".auth.v1")}}(e,s);if(i.__supabaseClients[t])return i.__supabaseClients[t];let n=(0,a.UU)(e,s,{auth:{persistSession:!0,autoRefreshToken:!0,flowType:"pkce",detectSessionInUrl:!0,storageKey:t},global:{headers:{"x-ayya-client":"web"}},realtime:{params:{eventsPerSecond:2}}});return i.__supabaseClients[t]=n,n}null!=i.__supabaseClients||(i.__supabaseClients={})}},e=>{e.O(0,[1029,5553,8441,1255,7358],()=>e(e.s=14579)),_N_E=e.O()}]);